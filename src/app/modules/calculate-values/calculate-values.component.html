<h1>Выберите тип системы</h1>
<app-system-animation *ngIf="isBrowser"></app-system-animation>
<div class="system-chooser-layout" fxLayout="row" fxLayoutAlign="space-around">
  <div class="form-layout" fxLayout="column" fxLayoutAlign="center center">
    <mat-form-field appearance="fill">
      <mat-label>Тип системы</mat-label>
      <mat-select [(value)]="selected" (selectionChange)="onSelectionChange()">
        <mat-option *ngFor="let system of systems" [value]="system.id">
          {{system.value}}
        </mat-option>
      </mat-select>
    </mat-form-field>
    <ng-container *ngIf="selected !== ''" >
      <ng-container [ngTemplateOutlet]="form"></ng-container>
      <p>
        После нажатия кнопки "Рассчитать", система вычислит оптимальное количество причалов.
      </p>
    </ng-container>
  </div>
  <div class="crane-icon">
    <ng-container *ngIf="!valuesCalculated" [ngTemplateOutlet]="cranePic"></ng-container>
    <ng-container *ngIf="valuesCalculated" [ngTemplateOutlet]="calculationResult"></ng-container>
  </div>
</div>

<ng-template #form>
  <form
    novalidate
    class="submit-form"
    [formGroup]="systemParametersForm"
    (ngSubmit)="_onSubmit()"
    fxLayout="column"
  >
    <div class="col-md-6">
      <mat-form-field appearance="standard">
        <mat-label>Количество судозаходов в день</mat-label>
        <input matInput
               type="number"
               class="form-control"
               [class.is-invalid]="isInvalid(lambda)"
               formControlName="lambda"
               required
        />
      </mat-form-field>
    </div>
    <div class="col-md-6">
      <mat-form-field appearance="standard">
        <mat-label class="form-label">Время обслуживания (день)</mat-label>
        <input matInput
               type="number"
               class="form-control"
               [class.is-invalid]="isInvalid(t)"
               formControlName="t"
               required
        />
      </mat-form-field>
    </div>
    <div class="col-md-6" *ngIf="selected === '3'">
      <mat-form-field appearance="standard">
        <mat-label class="form-label">Длина очереди</mat-label>
        <input matInput
               type="number"
               class="form-control"
               [class.is-invalid]="isInvalid(m)"
               formControlName="m"
               required
        />
      </mat-form-field>
    </div>
    <div class="button-wrapper" fxFlex="" fxFlexAlign="center">
      <button mat-flat-button class="btn btn-primary btn-lg" type="submit" color="primary">Рассчитать</button>
    </div>
  </form>

</ng-template>

<ng-template #calculationResult>
  <p>
    Для введенных значений, оптимальное количество каналов обслуживания (причалов) = {{calculatedParameters.optimalCapacity}}
  </p>
  <div style="display: block;">
    <canvas baseChart class="chart-canvas serving-probability"
            [datasets]="servingProbabilityData"
            [labels]="lineChartLabels"
            [options]="lineChartOptions"
            [colors]="probabilityColors"
            [legend]="lineChartLegend"
            [chartType]="lineChartType"
            [plugins]="lineChartPlugins">
    </canvas>
  </div>
  <div style="display: block;" *ngIf="selected === '3'">
    <canvas baseChart class="chart-canvas queue-length"
            [datasets]="queueLengthData"
            [labels]="lineChartLabels"
            [options]="lineChartOptions"
            [colors]="queueLengthColors"
            [legend]="lineChartLegend"
            [chartType]="lineChartType"
            [plugins]="lineChartPlugins">
    </canvas>
  </div>
  <div style="display: block;" *ngIf="selected === '3'">
    <canvas baseChart class="chart-canvas waiting-time"
            [datasets]="waitingTimeData"
            [labels]="lineChartLabels"
            [options]="lineChartOptions"
            [colors]="waitingTimeColors"
            [legend]="lineChartLegend"
            [chartType]="lineChartType"
            [plugins]="lineChartPlugins">
    </canvas>
  </div>
</ng-template>

<ng-template #cranePic>
  <svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
       viewBox="0 0 503.324 503.324" style="enable-background:new 0 0 503.324 503.324;" xml:space="preserve">
<g>
	<g>
		<path style="fill:#E6E7E8;" d="M364.475,121.492c-4.79,0-8.678-3.888-8.678-8.678v-43.39c0-4.79,3.888-8.678,8.678-8.678
			c4.79,0,8.678,3.888,8.678,8.678v43.39C373.153,117.604,369.265,121.492,364.475,121.492"/>
    <path style="fill:#E6E7E8;" d="M321.089,156.203c-2.543,0-5.068-1.111-6.777-3.254c-2.994-3.749-2.395-9.207,1.354-12.201
			l43.39-34.712c3.732-2.985,9.207-2.386,12.193,1.354c2.994,3.749,2.395,9.207-1.354,12.201l-43.39,34.712
			C324.907,155.579,322.99,156.203,321.089,156.203"/>
    <path style="fill:#E6E7E8;" d="M407.86,156.203c-1.9,0-3.818-0.625-5.415-1.9l-43.39-34.712
			c-3.749-2.994-4.348-8.452-1.354-12.201c2.994-3.749,8.461-4.339,12.193-1.354l43.39,34.712c3.749,2.994,4.348,8.452,1.354,12.201
			C412.928,155.093,410.403,156.203,407.86,156.203"/>
    <path style="fill:#E6E7E8;" d="M295.051,503.322h147.525l55.079-89.262c11.03-15.933,5.389-37.94-11.941-46.609l-96.62-50.888
			c-10.006-4.799-28.004-6.283-41.932,0l-94.755,51.356c-17.877,8.34-23.943,30.763-12.713,46.983L295.051,503.322z"/>
	</g>
  <path style="fill:#B0B6BB;" d="M270.071,358.346l77.095-41.784c13.919-6.283,31.926-4.799,41.932,0l77.798,40.986l10.388-88.533
		H260.335l9.659,89.331H270.071z"/>
  <polygon style="fill:#6D7CA0;" points="43.394,503.322 182.242,503.322 182.242,364.475 43.394,364.475 	"/>
  <polygon style="fill:#434C6D;" points="182.237,364.475 43.39,364.475 69.424,295.051 156.203,295.051 	"/>
  <polygon style="fill:#8697CB;" points="104.136,251.661 17.356,251.661 0,225.627 0,173.559 104.136,173.559 	"/>
  <path style="fill:#6D7CA0;" d="M399.186,34.712C399.186,15.542,383.644,0,364.475,0s-34.712,15.542-34.712,34.712
		s15.542,34.712,34.712,34.712S399.186,53.881,399.186,34.712"/>
  <path style="fill:#B0B6BB;" d="M390.508,412.587c-13.451-6.456-28.334-6.135-41.932,0l-84.072,41.949l30.546,48.788h147.525
		l30.477-49.395L390.508,412.587z"/>
  <polygon style="fill:#E6E7E8;" points="242.987,269.017 485.97,269.017 485.97,216.949 242.987,216.949 	"/>
  <polygon style="fill:#6D7CA0;" points="104.136,225.627 104.136,251.661 69.424,251.661 69.424,295.051 156.203,295.051
		156.203,225.627 	"/>
  <g>
		<path style="fill:#434C6D;" d="M329.763,34.712L104.136,173.559v52.068h52.068L364.475,69.424
			C345.305,69.424,329.763,53.881,329.763,34.712"/>
    <path style="fill:#434C6D;" d="M373.153,34.712c0-4.79-3.888-8.678-8.678-8.678c-4.79,0-8.678,3.888-8.678,8.678
			s3.888,8.678,8.678,8.678C369.265,43.39,373.153,39.502,373.153,34.712"/>
	</g>
  <polygon style="fill:#EE8472;" points="312.411,216.949 416.547,216.949 416.547,147.525 312.411,147.525 	"/>
  <g>
		<path style="fill:#DB776A;" d="M338.441,199.593c-4.79,0-8.678-3.888-8.678-8.678v-17.356c0-4.79,3.888-8.678,8.678-8.678
			c4.79,0,8.678,3.888,8.678,8.678v17.356C347.119,195.705,343.231,199.593,338.441,199.593"/>
    <path style="fill:#DB776A;" d="M364.475,199.593c-4.79,0-8.678-3.888-8.678-8.678v-17.356c0-4.79,3.888-8.678,8.678-8.678
			c4.79,0,8.678,3.888,8.678,8.678v17.356C373.153,195.705,369.265,199.593,364.475,199.593"/>
    <path style="fill:#DB776A;" d="M390.508,199.593c-4.79,0-8.678-3.888-8.678-8.678v-17.356c0-4.79,3.888-8.678,8.678-8.678
			c4.79,0,8.678,3.888,8.678,8.678v17.356C399.186,195.705,395.299,199.593,390.508,199.593"/>
	</g>
  <g>
		<path style="fill:#434C6D;" d="M95.458,477.288c4.79,0,8.678-3.888,8.678-8.678s-3.888-8.678-8.678-8.678H43.39v17.356H95.458z"/>
    <path style="fill:#434C6D;" d="M78.102,442.576c4.79,0,8.678-3.888,8.678-8.678s-3.888-8.678-8.678-8.678H43.39v17.356H78.102z"/>
	</g>
</g>
    <g>
</g>
    <g>
</g>
    <g>
</g>
    <g>
</g>
    <g>
</g>
    <g>
</g>
    <g>
</g>
    <g>
</g>
    <g>
</g>
    <g>
</g>
    <g>
</g>
    <g>
</g>
    <g>
</g>
    <g>
</g>
    <g>
</g>
</svg>
</ng-template>
